/*! fuzzycomplete 2016-05-09 */
!function(a){return"undefined"==typeof jQuery?void console.warn("fuzzyComplete plugin requires jQuery"):"undefinied"==typeof Fuse?void console.warn("fuzzyComplete plugin requires Fuse.js"):void(a.fn.fuzzyComplete=function(b,c){return this.each(function(){function d(){h.val(g.children(".selected").first().data("id")),f.val(g.children(".selected").first().text())}var e=new Fuse(b,c),f=a(this),g=a("<div>").addClass("fuzzyResults");f.after(g);var h=a("<select>").attr("name",f.attr("name")).hide();f.after(h),f.removeAttr("name");var i=f.position();i.left+=parseInt(f.css("marginLeft"),10),i.top+=parseInt(f.css("marginTop"),10),g.css({left:i.left,top:i.top+f.outerHeight(),width:f.outerWidth()}),f.keydown(function(a){switch(a.which){case 13:return a.preventDefault(),g.hide(),void d();case 9:return g.hide(),void d()}}),f.keyup(function(b){switch(b.which){case 38:var c=g.find(".selected").first();return c.length?(c.removeClass("selected"),c.prev().length?c.prev().addClass("selected"):g.children().last().addClass("selected")):g.children().last().addClass("selected"),void d();case 40:var c=g.find(".selected").first();return c.length?(c.removeClass("selected"),c.next().length?c.next().addClass("selected"):g.children().first().addClass("selected")):g.children().first().addClass("selected"),void d();case 13:return}var f=e.search(a(this).val());g.empty(),0==f.length&&h.val(null),f.forEach(function(b,c){c>=4||(0==c&&h.val(b.id),g.append(a("<div>").text(b.longname).data("id",b.id).addClass("__autoitem").on("mousedown",function(a){a.preventDefault()}).click(function(){g.find(".selected").removeClass("selected"),a(this).addClass("selected"),d(),g.hide()})))}),g.children().length?(g.show(),g.children().first().addClass("selected")):g.hide()}),f.blur(function(){g.hide()}),f.focus(function(){g.children().length&&g.show()}),h.append(a("<option>",{value:"",text:"(None Selected)"})),b.forEach(function(b,c){h.append(a("<option>",{value:b.id,text:b.longname}))}),f.val()&&(f.keyup(),f.blur())})})}(jQuery);